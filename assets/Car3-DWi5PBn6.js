import{r as n,O as ne}from"./index-DkU3-HG7.js";import{V as se,d as y,P as ae,e as re,D as ce,f as ie,g as x,h as p,i as k,j as de,k as he,u as ue,l as F,m as we,B as H,c as le}from"./useThreeRenderer-MHnwql4V.js";const me=()=>{const Y=n.useRef(null),I=n.useRef(null),C=n.useRef(null),R=n.useRef(null),E=new le,g=new se,L=n.useRef(new y(0,0,0)),q=new ae(new y(0,1,0),0),b=n.useRef(null),O=n.useRef(new y),P=n.useRef(!1),T=n.useCallback((t,a,o,f)=>{Y.current=t,I.current=o,o.position.set(50,70,50),a.shadowMap.enabled=!0,a.shadowMap.type=re;const e=new ce(16777215,2.8);e.position.set(-40,100,-40),e.castShadow=!0,e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,e.shadow.camera.near=.5,e.shadow.camera.far=500,e.shadow.camera.left=-500,e.shadow.camera.right=500,e.shadow.camera.top=500,e.shadow.camera.bottom=-500,t.add(e);const X=new ie(1e3,1e3),S=new x({color:6710886}),i=new p(X,S);i.rotation.x=Math.PI*-.5,i.receiveShadow=!0,t.add(i);const r=new k;r.position.set(0,2,0),r.rotation.y=Math.PI/2;const w=(c,m)=>{const s=new k;s.position.x=c,s.position.z=m;const d=new F(2,2,2,32),h=new x({color:13994275,shininess:100,transparent:!0,opacity:1,side:we});d.rotateX(Math.PI/2);const M=new p(d,h);s.add(M);const V=8,_=.5,$=2.4,ee=.8;for(let G=0;G<V;G++){const z=G/V*Math.PI*2,W=2,te=new H(ee,$,_),oe=new x({color:13994275}),u=new p(te,oe);u.position.x=Math.cos(z)*W,u.position.y=Math.sin(z)*W,u.position.z=0,u.rotation.z=z,u.rotateX(Math.PI/2),u.rotateY(Math.PI/2),s.add(u)}return s},l=(c,m,s=8)=>{const d=new F(.5,.5,s,32),h=new x({color:13994275});d.rotateX(Math.PI/2);const M=new p(d,h);return M.position.x=c,M.position.z=m,M},K=(c,m)=>{const s=new H(10,.6,5),d=new x({color:13994275}),h=new p(s,d);return h.position.x=c,h.position.z=m,h},j=[w(-5,-4),w(5,-4),w(-5,4),w(5,4)];C.current=j;const N=[l(5,0),l(-5,0)],A=l(6,-1,2),B=l(6,1,2);A.rotation.y=Math.PI/2,B.rotation.y=Math.PI/2;const Q=K(0,0);r.add(...j,...N,Q,A,B),r.traverse(c=>{c.isMesh&&(c.castShadow=!0)}),R.current=r,t.add(r);const U=new de(.5,16,16),Z=new he({color:16711680}),v=new p(U,Z);v.name="targetDot",b.current=v,t.add(v)},[]),{containerRef:J,setAnimation:D}=ue(T);return n.useEffect(()=>{const t=a=>{g.x=a.clientX/window.innerWidth*2-1,g.y=-(a.clientY/window.innerHeight)*2+1,E.setFromCamera(g,I.current);const o=new y;E.ray.intersectPlane(q,o),L.current.copy(o),b.current.position.copy(o)};return window.addEventListener("mousemove",t),()=>{window.removeEventListener("mousemove",t)}},[]),n.useEffect(()=>{D(()=>{if(!R.current)return!0;const t=R.current,a=L.current,o=a.x-t.position.x,f=a.z-t.position.z,e=Math.sqrt(o*o+f*f);if(e<1)P.current&&(P.current=!1);else{const S=Math.atan2(f,o);t.rotation.y=-S;const i=.02*Math.min(e,10),r=new y(i*o/e,0,i*f/e);t.position.add(r);const w=.05*(i/.1);C.current.forEach(l=>{l.rotation.z-=w}),P.current=!0}return O.current.copy(t.position),!0})},[D]),ne.jsx("div",{style:{width:"100%",height:"100vh"},ref:J})};export{me as default};
