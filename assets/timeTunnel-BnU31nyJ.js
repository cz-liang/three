import{r as L,O as j}from"./index-BCLU7ao4.js";import{u as D,V as F,aF as U,a2 as X,C as v,N as Y,ab as z,c as G}from"./useThreeRenderer-CrprxILV.js";const H=()=>{const s=new Map,e=L.useRef(),b=.003;let d=b,m=!1;const o=new F,h=()=>m=!0,x=()=>{m=!1,d=b},y=n=>{o.x=n.clientX/window.innerWidth*2-1,o.y=-(n.clientY/window.innerHeight)*2+1},E=()=>{o.x=1/0,o.y=1/0},{containerRef:g,setAnimation:R}=D((n,O,M,C)=>{e.current=g.current;const A=20,I=4,N=150,T=400,r=new U(A,I,N,T),P=new X({size:.1,transparent:!0,opacity:1,vertexColors:!0,color:16777215}),a=new Float32Array(r.attributes.position.count*3);for(let t=0;t<r.attributes.position.count;t++){const u=new v("#00e9ec");a[t*3]=u.r,a[t*3+1]=u.g,a[t*3+2]=u.b}r.setAttribute("color",new Y(a,3));const c=new z(r,P);c.rotation.x=Math.PI/2,n.add(c),M.position.set(20,0,5),C.target.set(20,0,5),e.current.addEventListener("mousedown",h),e.current.addEventListener("mouseup",x),e.current.addEventListener("mousemove",y),e.current.addEventListener("mouseleave",E);const f=new G;f.params.Points.threshold=.5,R(()=>{if(m&&(d+=5e-5),c.rotation.z+=d,!isNaN(o.x)&&!isNaN(o.y)){f.setFromCamera(o,M);const t=f.intersectObject(c);if(t.length>0){const i=t[0].index;if(!s.has(i)){const p=new v("#ff0000"),l=r.attributes.color;l.setXYZ(i,p.r,p.g,p.b),l.needsUpdate=!0;const S=setTimeout(()=>{const w=new v("#00e9ec");l.setXYZ(i,w.r,w.g,w.b),l.needsUpdate=!0,s.delete(i)},500);s.set(i,S)}}}})});return L.useEffect(()=>()=>{console.log("时光隧道,清理"),s.forEach(n=>clearTimeout(n)),s.clear(),e.current.removeEventListener("mousedown",h),e.current.removeEventListener("mouseup",x),e.current.removeEventListener("mouseleave",E),e.current.removeEventListener("mousemove",y)},[]),j.jsx("div",{ref:g,style:{width:"100%",height:"100%"}})};export{H as default};
